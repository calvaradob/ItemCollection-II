{"ast":null,"code":"var _jsxFileName = \"/Users/solandrea/Desktop/Escuela Digital/Entregas-React/Ejemplo e-commerce/src/components/Cart/PrePurchase/PrePurchase.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { CartContext } from \"../../../contexts/cartContext\";\nimport { toast } from \"react-toastify\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nrequire('dotenv').config();\n\nexport default function PrePurchase(props) {\n  _s();\n\n  const history = useHistory();\n  const [setCart] = useContext(CartContext);\n  const [visible, setVisible] = useState(false);\n\n  const checkout = e => {\n    e.preventDefault();\n    let name = document.getElementById(\"chName\").value;\n    let phone = document.getElementById(\"chPhone\").value;\n    let email = document.getElementById(\"chEmail\").value;\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n    var raw = JSON.stringify({\n      buyer: {\n        name: name,\n        phone: phone,\n        email: email\n      },\n      products: props.products,\n      total: props.total\n    });\n    var requestOptions = {\n      method: \"POST\",\n      headers: myHeaders,\n      body: raw,\n      redirect: \"follow\"\n    };\n    fetch(`${process.env.REACT_APP_API_URL}/bought`, requestOptions).then(response => response.json()).then(result => {\n      console.log(result);\n      toast.success(`Orden creada con exito, su ID de compra es: ${result._id}`, {\n        position: \"top-right\",\n        autoClose: false,\n        hideProgressBar: false,\n        closeOnClick: true,\n        pauseOnHover: true,\n        draggable: true,\n        progress: undefined\n      });\n      actualizarStock();\n      history.push(\"/\");\n    }).catch(error => console.log(\"error\", error));\n  };\n\n  const actualizarStock = () => {\n    props.items.map(product => {\n      fetch(`${process.env.REACT_APP_API_URL}/products/${product.itemId}`).then(response => {\n        return response.json();\n      }).then(res => {\n        let newStock = res.stock - product.count;\n        var myHeaders = new Headers();\n        myHeaders.append(\"Content-Type\", \"application/json\");\n        var raw = JSON.stringify({\n          stock: newStock\n        });\n        var requestOptions = {\n          method: \"PUT\",\n          headers: myHeaders,\n          body: raw,\n          redirect: \"follow\"\n        };\n        fetch(`${process.env.REACT_APP_API_URL}/products/${product.itemId}`, requestOptions).then(res => console.log(res));\n      });\n    });\n  };\n\n  const verifyEmail = () => {\n    if (document.getElementById(\"chEmail\").value === document.getElementById(\"chVerifyEmail\").value) {\n      setVisible(true);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"form-row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group col-md-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"chName\",\n            children: \"Nombre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            id: \"chName\",\n            placeholder: \"Nombre\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group col-md-6\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"chPhone\",\n            children: \"Telefono\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            id: \"chPhone\",\n            placeholder: \"11-1234-5678\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group col-md-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"chEmail\",\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"email\",\n            className: \"form-control\",\n            id: \"chEmail\",\n            placeholder: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group col-md-12\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"chEmail\",\n            children: \"Verify Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"verifyEmail\",\n            className: \"form-control\",\n            id: \"chVerifyEmail\",\n            placeholder: \"Re enter Email\",\n            onChange: verifyEmail\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this), visible !== false ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-12 text-right\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            onClick: checkout,\n            className: \"btn btn-success\",\n            children: \"Finalizar Compra\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 13\n        }, this) : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PrePurchase, \"lzxh2DLNsU8E2ytqutZYJMH1yOQ=\", false, function () {\n  return [useHistory];\n});\n\n_c = PrePurchase;\n\nvar _c;\n\n$RefreshReg$(_c, \"PrePurchase\");","map":{"version":3,"names":["React","useContext","useState","useHistory","CartContext","toast","require","config","PrePurchase","props","history","setCart","visible","setVisible","checkout","e","preventDefault","name","document","getElementById","value","phone","email","myHeaders","Headers","append","raw","JSON","stringify","buyer","products","total","requestOptions","method","headers","body","redirect","fetch","process","env","REACT_APP_API_URL","then","response","json","result","console","log","success","_id","position","autoClose","hideProgressBar","closeOnClick","pauseOnHover","draggable","progress","undefined","actualizarStock","push","catch","error","items","map","product","itemId","res","newStock","stock","count","verifyEmail"],"sources":["/Users/solandrea/Desktop/Escuela Digital/Entregas-React/Ejemplo e-commerce/src/components/Cart/PrePurchase/PrePurchase.js"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { CartContext } from \"../../../contexts/cartContext\";\nimport { toast } from \"react-toastify\";\n\nrequire('dotenv').config()\n\nexport default function PrePurchase(props) {\n  const history = useHistory();\n  const [setCart] = useContext(CartContext);\n  const [visible, setVisible] = useState(false);\n\n  const checkout = (e) => {\n    e.preventDefault();\n\n    let name = document.getElementById(\"chName\").value;\n    let phone = document.getElementById(\"chPhone\").value;\n    let email = document.getElementById(\"chEmail\").value;\n\n    var myHeaders = new Headers();\n    myHeaders.append(\"Content-Type\", \"application/json\");\n\n    var raw = JSON.stringify({\n      buyer: { name: name, phone: phone, email: email },\n      products: props.products,\n      total: props.total,\n    });\n\n    var requestOptions = {\n      method: \"POST\",\n      headers: myHeaders,\n      body: raw,\n      redirect: \"follow\",\n    };\n\n    fetch(`${process.env.REACT_APP_API_URL}/bought`, requestOptions)\n      .then((response) => response.json())\n      .then((result) => {\n        console.log(result);\n\n        toast.success(\n          `Orden creada con exito, su ID de compra es: ${result._id}`,\n          {\n            position: \"top-right\",\n            autoClose: false,\n            hideProgressBar: false,\n            closeOnClick: true,\n            pauseOnHover: true,\n            draggable: true,\n            progress: undefined,\n          }\n        );\n        actualizarStock();\n        history.push(\"/\");\n      })\n      .catch((error) => console.log(\"error\", error));\n  };\n\n  const actualizarStock = () => {\n    props.items.map((product) => {\n      fetch(\n        `${process.env.REACT_APP_API_URL}/products/${product.itemId}`\n      )\n        .then((response) => {\n          return response.json();\n        })\n        .then((res) => {\n\n          let newStock = res.stock - product.count;\n\n          var myHeaders = new Headers();\n          myHeaders.append(\"Content-Type\", \"application/json\");\n\n          var raw = JSON.stringify({\n            stock: newStock,\n          });\n\n          var requestOptions = {\n            method: \"PUT\",\n            headers: myHeaders,\n            body: raw,\n            redirect: \"follow\",\n          };\n\n          fetch(\n            `${process.env.REACT_APP_API_URL}/products/${product.itemId}`,\n            requestOptions\n          ).then((res) => console.log(res));\n        });\n    });\n  };\n\n  const verifyEmail = () => {\n    if (\n      document.getElementById(\"chEmail\").value ===\n      document.getElementById(\"chVerifyEmail\").value\n    ) {\n      setVisible(true);\n    }\n  };\n\n  return (\n    <div>\n      <form>\n        <div className=\"form-row\">\n          <div className=\"form-group col-md-6\">\n            <label htmlFor=\"chName\">Nombre</label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              id=\"chName\"\n              placeholder=\"Nombre\"\n            />\n          </div>\n          <div className=\"form-group col-md-6\">\n            <label htmlFor=\"chPhone\">Telefono</label>\n            <input\n              type=\"text\"\n              className=\"form-control\"\n              id=\"chPhone\"\n              placeholder=\"11-1234-5678\"\n            />\n          </div>\n          <div className=\"form-group col-md-12\">\n            <label htmlFor=\"chEmail\">Email</label>\n            <input\n              type=\"email\"\n              className=\"form-control\"\n              id=\"chEmail\"\n              placeholder=\"Email\"\n            />\n          </div>\n          <div className=\"form-group col-md-12\">\n            <label htmlFor=\"chEmail\">Verify Email</label>\n            <input\n              type=\"verifyEmail\"\n              className=\"form-control\"\n              id=\"chVerifyEmail\"\n              placeholder=\"Re enter Email\"\n              onChange={verifyEmail}\n            />\n          </div>\n          {visible !== false ? (\n            <div className=\"col-12 text-right\">\n              <button\n                type=\"submit\"\n                onClick={checkout}\n                className=\"btn btn-success\"\n              >\n                Finalizar Compra\n              </button>\n            </div>\n          ) : (\n            \"\"\n          )}\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}